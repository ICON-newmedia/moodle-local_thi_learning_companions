{"version":3,"file":"learningcompanions_chat.min.js","sources":["../src/learningcompanions_chat.js"],"sourcesContent":["/* eslint-disable no-console, no-unused-vars, max-len, jsdoc/require-jsdoc, no-inner-declarations */\r\nimport $ from 'jquery';\r\nimport * as str from 'core/str';\r\nimport * as ModalFactory from 'core/modal_factory';\r\nimport * as ModalEvents from 'core/modal_events';\r\nimport {\r\n    handleGroupLeaveButton,\r\n    handleGroupRequestButton,\r\n    handleGroupInviteButton\r\n} from 'local_learningcompanions/group';\r\n\r\nlet strings = [];\r\n\r\nexport const init = async() => {\r\n    // Put send button to the right next to the message box\r\n    // we can't arrange it that way with just Moodle Forms API\r\n    const sendButton = $('#local_learningcompanions_chat-send');\r\n    const messageBox = $('#id_messageeditable');\r\n    messageBox.after(sendButton);\r\n    // Add event listener to the send button to handle message sending\r\n    sendButton.on('click', handleNewMessageSubmit);\r\n\r\n    addBBBlinkButton();\r\n\r\n    const stringsObj = [\r\n        {key: 'modal-deletecomment-title', component: 'local_learningcompanions'},\r\n        {key: 'modal-deletecomment-text', component: 'local_learningcompanions'},\r\n        {key: 'modal-deletecomment-okaybutton', component: 'local_learningcompanions'},\r\n        {key: 'modal-editcomment-title', component: 'local_learningcompanions'},\r\n        {key: 'modal-editcomment-okaybutton', component: 'local_learningcompanions'},\r\n        {key: 'modal-reportcomment-title', component: 'local_learningcompanions'},\r\n        {key: 'modal-reportcomment-text', component: 'local_learningcompanions'},\r\n        {key: 'modal-reportcomment-okaybutton', component: 'local_learningcompanions'},\r\n    ];\r\n\r\n    // eslint-disable-next-line no-return-assign\r\n    str.get_strings(stringsObj).then(results => strings = results);\r\n\r\n    const body = $('body');\r\n\r\n    body.on('click', '.learningcompanions_delete_comment', handleCommentDelete);\r\n    body.on('click', '.learningcompanions_edit_comment', handleCommentEdit);\r\n    body.on('click', '.learningcompanions_report_comment', handleCommentReport);\r\n    body.on('click', '.learningcompanions_rate_comment', handleCommentRating);\r\n    body.on('click', '.learningcompanions_editgroup', handleEditGroup);\r\n\r\n    body.on('click', '.js-leave-group', handleGroupLeaveButton);\r\n    body.on('click', '.js-request-join-group', handleGroupRequestButton);\r\n    body.on('click', '.js-invite-member', handleGroupInviteButton);\r\n    body.on('click', '.learningcompanions_bbb_button', handleBBBButton);\r\n    let item = document.querySelector('#page-local-learningcompanions-chat #fitem_id_attachments');\r\n    document.body.addEventListener('dragenter', function(e) {\r\n        // console.log('started dragging', e);\r\n        document.querySelector('#page-local-learningcompanions-chat #fitem_id_attachments').classList.add('upload-visible');\r\n    });\r\n    // document.body.addEventListener('dragstop', function(e) {\r\n    //     console.log('stopped dragging', e);\r\n    //     document.querySelector('#page-local-learningcompanions-chat #fitem_id_attachments').classList.remove('upload-visible');\r\n    // });\r\n};\r\n\r\nconst addBBBlinkButton = function() {\r\n    var string = str.get_string(  'bigbluebutton_title', 'local_learningcompanions');\r\n    string.then((title) => {\r\n        if ($('.atto_editor_row').length > 0) {\r\n            var appendTo = '#page-local-learningcompanions-chat .atto_toolbar_row:first-child';\r\n        } else {\r\n            var appendTo = '#page-local-learningcompanions-chat .editor_atto_toolbar';\r\n        }\r\n        $().add('<div class=\"atto_group accessibility_group\"><button class=\"learningcompanions_bbb_button\" title=\"' + title + '\")>BigBlueButton</button></div>').appendTo(appendTo);\r\n    });\r\n};\r\nconst handleBBBButton = function(e){\r\n    e.preventDefault();\r\n    var sel = window.getSelection();\r\n    let messageEditorSelected = false;\r\n    const messageEditor = document.getElementById('id_messageeditable');\r\n    // eslint-disable-next-line no-cond-assign\r\n    while (sel = sel.parentNode){\r\n        if (sel.id === 'id_messageeditable') {\r\n            messageEditorSelected = true;\r\n            break;\r\n        }\r\n    }\r\n    if (!messageEditorSelected) {\r\n        document.getSelection().removeAllRanges();\r\n        messageEditor.focus();\r\n        const range = new Range();\r\n        const childElementCount = messageEditor.childElementCount;\r\n        range.setStartAfter(messageEditor.children[childElementCount - 1]);\r\n        document.getSelection().addRange(range);\r\n    }\r\n    var string = str.get_string('bigbluebutton_join_text', 'local_learningcompanions');\r\n    var chatid = $('.chat-post-form input[name=\"chatid\"]').val();\r\n    var bbbURLs = $.ajax(M.cfg.wwwroot + '/local/learningcompanions/ajax/ajax_videocall.php', {data: {chatid:chatid}});\r\n    Promise.all([string,bbbURLs]).then((data) => {\r\n        const urls = data[1];\r\n        window.open(urls['moderator'], '_blank');\r\n        pasteHtmlAtCaret(' <a target=\"_blank\" href=\"' + urls['participants'] + '\">' + data[0] + '</a>');\r\n\r\n    });\r\n    // ICTODO: Create a new BBB room, then create a link that the users can use to join the room, all via AJAX\r\n    return false;\r\n};\r\nconst pasteHtmlAtCaret = function(html) {\r\n    var sel, range;\r\n    if (window.getSelection) {\r\n        // IE9 and non-IE\r\n        sel = window.getSelection();\r\n        if (sel.getRangeAt && sel.rangeCount) {\r\n            range = sel.getRangeAt(0);\r\n            range.deleteContents();\r\n\r\n            // Range.createContextualFragment() would be useful here but is\r\n            // only relatively recently standardized and is not supported in\r\n            // some browsers (IE9, for one)\r\n            var el = document.createElement(\"div\");\r\n            el.innerHTML = html;\r\n            var frag = document.createDocumentFragment(), node, lastNode;\r\n            while ( (node = el.firstChild) ) {\r\n                lastNode = frag.appendChild(node);\r\n            }\r\n            range.insertNode(frag);\r\n\r\n            // Preserve the selection\r\n            if (lastNode) {\r\n                range = range.cloneRange();\r\n                range.setStartAfter(lastNode);\r\n                range.collapse(true);\r\n                sel.removeAllRanges();\r\n                sel.addRange(range);\r\n            }\r\n        }\r\n    } else if (document.selection && document.selection.type != \"Control\") {\r\n        // IE < 9\r\n        document.selection.createRange().pasteHTML(html);\r\n    }\r\n};\r\nconst handleCommentRating = function(e) {\r\n    const postId = +e.target.dataset.id;\r\n    $.ajax({\r\n        url: M.cfg.wwwroot + '/local/learningcompanions/ajax/ajax_ratecomment.php',\r\n        method: 'POST',\r\n        dataType: 'json',\r\n        data: {\r\n            commentid: postId\r\n        },\r\n        success: function(data) {\r\n            // modal.destroy();\r\n            if (data === 'fail') {\r\n                // ICTODO: output fail message\r\n            } else {\r\n                // ICTODO: output success message\r\n            }\r\n            document.dispatchEvent(new CustomEvent('learningcompanions_message_rated', {detail: {postid: postId, newvalue: data.israted}}));\r\n            // document.dispatchEvent(new ModalEvents.hidden);\r\n        }\r\n    });\r\n}\r\nconst handleCommentDelete = async function(e) {\r\n    const postId = +e.target.dataset.id;\r\n\r\n    const modal = await ModalFactory.create({\r\n        type: ModalFactory.types.SAVE_CANCEL,\r\n        title: strings[0],\r\n        body: '' +\r\n            '<div id=\"learningcompanions-deletecomment-modal\">' +\r\n            '<div id=\"learningcompanions-deletecomment-modal-text\">' + strings[1] + '</div>' +\r\n            '</div>',\r\n    });\r\n\r\n    // console.log('comment id from data:', postId);\r\n\r\n    modal.getRoot().on(ModalEvents.save, function() {\r\n        $.ajax({\r\n            url: M.cfg.wwwroot + '/local/learningcompanions/ajax/ajaxdeletecomment.php',\r\n            method: 'POST',\r\n            dataType: 'json',\r\n            data: {\r\n                commentid: postId\r\n            },\r\n            success: function(data) {\r\n                // modal.destroy();\r\n                if (data === 'fail') {\r\n                    // ICTODO: output fail message\r\n                } else {\r\n                    // ICTODO: output success message\r\n                }\r\n                document.dispatchEvent(new CustomEvent('learningcompanions_message_deleted', {detail: {postid: postId}}));\r\n                // document.dispatchEvent(new ModalEvents.hidden);\r\n            }\r\n        });\r\n    });\r\n    modal.setSaveButtonText(strings[2]);\r\n    modal.show();\r\n};\r\nconst handleCommentEdit = async function(e) {\r\n    // console.log('clicked edit comment. event object:', e);\r\n    // console.log('clicked edit comment for comment id:', e.target.dataset.id);\r\n    var commentid = e.target.dataset.id;\r\n    // console.log('commentid before creating modal:', commentid);\r\n    // console.log(ModalFactory);\r\n    return ModalFactory.create({\r\n        type: ModalFactory.types.SAVE_CANCEL,\r\n        title: strings[3],\r\n        body: '' +\r\n            '<div id=\"learningcompanions-edit-modal\">' +\r\n            '<div id=\"learningcompanions-edit-modal-text\">' + strings[4] + '</div>' +\r\n            '</div>',\r\n        // footer: '' +\r\n        //     '<div id=\"learningcompanions-deletecomment-modal-buttons\">' +\r\n        //     '<button class=\"btn btn-primary\" aria-hidden=\"true\" id=\"learningcompanions-deletecomment-modal-delete\" data-cid=\"' + commentid + '\">' + strings[2] + '</button>' +\r\n        //     '<button class=\"btn btn-secondary\" aria-hidden=\"true\" id=\"learningcompanions-deletecomment-modal-close\" data-action=\"hide\">' + strings[3] + '</button>' +\r\n        //     '</div>'\r\n    }).then(function(modal) {\r\n        // console.log('edit comment id from data:', commentid);\r\n\r\n        modal.setSaveButtonText(strings[5]);\r\n        $.ajax(\r\n            {\r\n                url: M.cfg.wwwroot + '/local/learningcompanions/editcomment.php',\r\n                method: 'POST',\r\n                dataType: 'json',\r\n                data: {\r\n                    commentid: commentid\r\n                }\r\n            }\r\n        ).done(function(a, b, c) {\r\n            // console.log('inside edit comment. a:', a, 'b:', b, 'c:', c);\r\n            modal.setText(a.text);\r\n        });\r\n        // modal.getRoot().on(ModalEvents.hidden, function () {\r\n        //     modal.destroy();\r\n        // });\r\n        modal.show();\r\n    });\r\n};\r\nconst handleCommentReport = async function(e) {\r\n    const postId = +e.target.dataset.id;\r\n\r\n    return ModalFactory.create({\r\n        type: ModalFactory.types.SAVE_CANCEL,\r\n        title: strings[5],\r\n        body: '' +\r\n            '<div id=\"learningcompanions-reportcomment-modal\">' +\r\n            '<div id=\"learningcompanions-reportcomment-modal-text\">' + strings[6] + '</div>' +\r\n            '</div>'\r\n    }).then(function(modal) {\r\n        // console.log('comment id from data:', postId);\r\n\r\n        modal.getRoot().on(ModalEvents.save, function() {\r\n            // console.log('about to call ajaxdeletecomment.php with comment id', postId);\r\n            $.ajax({\r\n                url: `${M.cfg.wwwroot}/local/learningcompanions/ajax/ajaxreport.php`,\r\n                method: 'POST',\r\n                dataType: 'json',\r\n                data: {\r\n                    commentid: postId\r\n                },\r\n                success: function(data) {\r\n                    // modal.destroy();\r\n                    if (data === 'fail') {\r\n                        // ICTODO: output fail message\r\n                    } else {\r\n                        // ICTODO: output success message\r\n                    }\r\n                    document.dispatchEvent(new CustomEvent('learningcompanions_message_reported', {detail: {postid: postId}}));\r\n                    // document.dispatchEvent(ModalEvents.hidden);\r\n                }\r\n            });\r\n        });\r\n        modal.setSaveButtonText(strings[7]);\r\n        modal.show();\r\n    });\r\n};\r\nconst handleEditGroup = async function(e) {\r\n    // console.log('clicked on gear icon', this, e);\r\n\r\n    async function callGroupModal(e) {\r\n        e.preventDefault();\r\n\r\n        const groupid = e.target.dataset.gid;\r\n        const groupname = e.target.dataset.title;\r\n        // console.log('getting group modal for ', groupid, groupname, this, e);\r\n        const groupDetails = $.ajax({\r\n            url: M.cfg.wwwroot + '/local/learningcompanions/ajax/ajax.php',\r\n            method: 'POST',\r\n            dataType: 'json',\r\n            data: {\r\n                action: 'getgroupdetails',\r\n                groupid: groupid\r\n            },\r\n            success: function(data) {\r\n                const title = str.get_string('modal-groupdetails-groupname', 'local_learningcompanions', groupname);\r\n                title.then(function(string) {\r\n                    // console.log('got group title string:', title);\r\n                    // console.log('got group details data:', data);\r\n                    ModalFactory.create({\r\n                        title: string,\r\n                        body: data.html,\r\n                        footer: '',\r\n                        large: true,\r\n                        type: ModalFactory.types.CANCEL,\r\n                    }).then(modal => {\r\n                        modal.show();\r\n                    });\r\n                });\r\n            }\r\n        });\r\n    }\r\n\r\n    callGroupModal(e).then(() => {\r\n        console.log('called modal for group details. What now?');\r\n    });\r\n};\r\n\r\nconst handleNewMessageSubmit = (e) => {\r\n    if (e.target.getAttribute(\"disabled\") === true) {\r\n        return;\r\n    }\r\n    // ICTODO: disable the form/grey it out, while data is getting sent\r\n    e.preventDefault();\r\n    const data = {};\r\n    $('#learningcompanions_chat form input, #learningcompanions_chat form textarea').each((index, el) => {\r\n        data[el.name] = el.value;\r\n    });\r\n    $('#learningcompanions_chat #id_messageeditable').css('opacity', '0.5');\r\n    $('#learningcompanions_chat #id_messageeditable').attr('contenteditable', 'false');\r\n    $('#learningcompanions_chat form input,  #learningcompanions_chat form textarea, #local_learningcompanions_chat-send').attr('disabled', true);\r\n    $.post(\r\n        M.cfg.wwwroot + \"/local/learningcompanions/ajax/ajaxsubmit.php\",\r\n        data\r\n    ).done(function(a, b, c) {\r\n        // ICTODO: give a success message, like with a toast or so\r\n        // reset the form to empty values after successfully sending the form\r\n        $('#learningcompanions_chat form #id_messageeditable').text(\"\");\r\n        $('#learningcompanions_chat form input, #learningcompanions_chat form textarea').each((index, el) => {\r\n            if (el.name == \"textarea\" || el.type !== \"hidden\") {\r\n                el.value = '';\r\n            }\r\n        });\r\n        document.dispatchEvent(new CustomEvent('learningcompanions_message_send'));\r\n    }).fail(function(a, b, c) {\r\n        console.warn('Failed sending via AJAX', a, b, c);\r\n        window.alert(\"couldn't save\"); // ICTODO: give proper message, via get_string and ideally with a modal\r\n    }).always(function() {\r\n        // reactivate the form/ungrey it when data has been sent\r\n        $('#learningcompanions_chat #id_messageeditable').css('opacity', '1');\r\n        $('#learningcompanions_chat #id_messageeditable').attr('contenteditable', 'true');\r\n        $('#learningcompanions_chat form input,  #learningcompanions_chat form textarea, #local_learningcompanions_chat-send').attr('disabled', false);\r\n    });\r\n    return false;\r\n};\r\n"],"names":["strings","async","sendButton","after","on","handleNewMessageSubmit","addBBBlinkButton","str","get_strings","key","component","then","results","body","handleCommentDelete","handleCommentEdit","handleCommentReport","handleCommentRating","handleEditGroup","handleGroupLeaveButton","handleGroupRequestButton","handleGroupInviteButton","handleBBBButton","document","querySelector","addEventListener","e","classList","add","get_string","title","length","appendTo","preventDefault","sel","window","getSelection","messageEditorSelected","messageEditor","getElementById","parentNode","id","removeAllRanges","focus","range","Range","childElementCount","setStartAfter","children","addRange","string","chatid","val","bbbURLs","$","ajax","M","cfg","wwwroot","data","Promise","all","urls","open","pasteHtmlAtCaret","html","getRangeAt","rangeCount","deleteContents","el","createElement","innerHTML","node","lastNode","frag","createDocumentFragment","firstChild","appendChild","insertNode","cloneRange","collapse","selection","type","createRange","pasteHTML","postId","target","dataset","url","method","dataType","commentid","success","dispatchEvent","CustomEvent","detail","postid","newvalue","israted","modal","ModalFactory","create","types","SAVE_CANCEL","getRoot","ModalEvents","save","setSaveButtonText","show","done","a","b","c","setText","text","groupid","gid","groupname","action","footer","large","CANCEL","callGroupModal","console","log","getAttribute","each","index","name","value","css","attr","post","fail","warn","alert","always"],"mappings":"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"}