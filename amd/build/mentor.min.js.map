{"version":3,"file":"mentor.min.js","sources":["../src/mentor.js"],"sourcesContent":["/* eslint-disable max-len, jsdoc/require-jsdoc, require-jsdoc */\r\ndefine([\r\n    'jquery',\r\n    'core/config',\r\n    'core/str',\r\n    'core/modal_factory',\r\n    'core/modal_events',\r\n    'local_thi_learning_companions/datatables-helpers',\r\n    // 'local_thi_learning_companions/jquery.dataTables',\r\n    'local_thi_learning_companions/datatables',\r\n    'local_thi_learning_companions/select2'\r\n], function($, c, str, ModalFactory, ModalEvents, datatablesHelpers) {\r\n    async function initDatatables() {\r\n        datatablesHelpers.initMinSearch('.js-mentor-filter--min');\r\n        datatablesHelpers.initIncludeSearch('.js-mentor-filter--includes');\r\n\r\n        var languageUrl = await str.get_string('datatables_url', 'local_thi_learning_companions');\r\n        languageUrl = M.cfg.wwwroot + languageUrl;\r\n\r\n        $('#askedquestionstable').DataTable({\r\n            language: {\r\n                url: languageUrl\r\n            },\r\n            initComplete: function() {\r\n                datatablesHelpers.makeTablesFullWidth();\r\n            }\r\n        });\r\n        $('#mymentorquestionstable').DataTable({\r\n            language: {\r\n                url: languageUrl\r\n            },\r\n            initComplete: function() {\r\n                datatablesHelpers.makeTablesFullWidth();\r\n            }\r\n        });\r\n        $('#allmentorquestionstable').DataTable({\r\n            language: {\r\n                url: languageUrl\r\n            },\r\n            initComplete: function() {\r\n                datatablesHelpers.makeTablesFullWidth();\r\n            }\r\n        });\r\n        $('#allmentorstable').DataTable({\r\n            dom: 'lrtip',\r\n            language: {\r\n                url: languageUrl,\r\n            },\r\n            initComplete: function() {\r\n                const table = this.api();\r\n\r\n                datatablesHelpers.setupSearchRules('.js-mentor-filter--search', table);\r\n\r\n                datatablesHelpers.addRedrawEvent('.js-mentor-filter', table);\r\n                datatablesHelpers.makeTablesFullWidth();\r\n            },\r\n            columnDefs: [\r\n                {orderable: false, visible: false, targets: 'no-show'}\r\n            ]\r\n        });\r\n        $('.lc_datatable').DataTable({\r\n            language: {\r\n                url: languageUrl\r\n            },\r\n            initComplete: function() {\r\n                datatablesHelpers.makeTablesFullWidth();\r\n            }\r\n        });\r\n    }\r\n\r\n    return {\r\n\r\n        select2: function() {\r\n            $('.select2').select2();\r\n        },\r\n\r\n        init: function() {\r\n            initDatatables();\r\n\r\n            $('.askedquestions-delete').click(function(e) {\r\n                e.preventDefault();\r\n\r\n                const questionid = $(this).data('qid');\r\n                const question = $(this).data('question');\r\n\r\n                var strings = [\r\n                    {key: 'modal-deletemyquestion-title', component: 'local_thi_learning_companions'},\r\n                    {key: 'modal-deletemyquestion-text', component: 'local_thi_learning_companions', param: question},\r\n                    {key: 'modal-deletemyquestion-okaybutton', component: 'local_thi_learning_companions'},\r\n                    {key: 'modal-deletemyquestion-cancelbutton', component: 'local_thi_learning_companions'},\r\n                ];\r\n\r\n                str.get_strings(strings).then(function(strings) {\r\n                    return ModalFactory.create({\r\n                        title: strings[0],\r\n                        body: '' +\r\n                            '<div id=\"mentor-deletemyquestion-modal\">' +\r\n                            '<div id=\"mentor-deletemyquestion-modal-text\">' + strings[1] + '</div>' +\r\n                            '</div>',\r\n                        footer: '' +\r\n                            '<div id=\"mentor-deletemyquestion-modal-buttons\">' +\r\n                            '<button class=\"btn btn-primary\" aria-hidden=\"true\" id=\"mentor-deletemyquestion-modal-delete\" data-qid=\"' + questionid + '\">' + strings[2] + '</button>' +\r\n                            '<button class=\"btn btn-secondary\" aria-hidden=\"true\" id=\"mentor-deletemyquestion-modal-close\" data-action=\"hide\">' + strings[3] + '</button>' +\r\n                            '</div>'\r\n                    });\r\n                }).then(function(modal) {\r\n                    modal.getRoot().on(ModalEvents.hidden, function() {\r\n                        modal.destroy();\r\n                    });\r\n                    modal.show();\r\n                });\r\n            });\r\n\r\n            $('body').on('click', '#mentor-deletemyquestion-modal-delete', function() {\r\n\r\n                const questionid = $(this).data('qid');\r\n\r\n                $.ajax({\r\n                    url: M.cfg.wwwroot + '/local/thi_learning_companions/ajax/ajax.php',\r\n                    method: 'POST',\r\n                    dataType: 'json',\r\n                    data: {\r\n                        action: 'deletemyquestion',\r\n                        questionid: questionid,\r\n                        sesskey: M.cfg.sesskey,\r\n                    },\r\n                    success: function (data) {\r\n                        if (data === 'fail') {\r\n                            window.location.href = (M.cfg.wwwroot + '/local/thi_learning_companions/mentor/index.php?n=n_d');\r\n                        } else {\r\n                            window.location.href = (M.cfg.wwwroot + '/local/thi_learning_companions/mentor/index.php?n=d');\r\n                        }\r\n                    }\r\n                });\r\n            });\r\n\r\n            $('body').on('click', '#mentor-deletemyquestion-modal-close', function() {\r\n                $('.modal').remove();\r\n            });\r\n        }\r\n\r\n    };\r\n});\r\n"],"names":["define","$","c","str","ModalFactory","ModalEvents","datatablesHelpers","select2","init","initMinSearch","initIncludeSearch","languageUrl","get_string","M","cfg","wwwroot","DataTable","language","url","initComplete","makeTablesFullWidth","dom","table","this","api","setupSearchRules","addRedrawEvent","columnDefs","orderable","visible","targets","initDatatables","click","e","preventDefault","questionid","data","strings","key","component","param","get_strings","then","create","title","body","footer","modal","getRoot","on","hidden","destroy","show","ajax","method","dataType","action","sesskey","success","window","location","href","remove"],"mappings":"AACAA,8CAAO,CACH,SACA,cACA,WACA,qBACA,oBACA,mDAEA,2CACA,0CACD,SAASC,EAAGC,EAAGC,IAAKC,aAAcC,YAAaC,yBA2DvC,CAEHC,QAAS,WACLN,EAAE,YAAYM,WAGlBC,KAAM,6BA/DNF,kBAAkBG,cAAc,0BAChCH,kBAAkBI,kBAAkB,mCAEhCC,kBAAoBR,IAAIS,WAAW,iBAAkB,iCACzDD,YAAcE,EAAEC,IAAIC,QAAUJ,YAE9BV,EAAE,wBAAwBe,UAAU,CAChCC,SAAU,CACNC,IAAKP,aAETQ,aAAc,WACVb,kBAAkBc,yBAG1BnB,EAAE,2BAA2Be,UAAU,CACnCC,SAAU,CACNC,IAAKP,aAETQ,aAAc,WACVb,kBAAkBc,yBAG1BnB,EAAE,4BAA4Be,UAAU,CACpCC,SAAU,CACNC,IAAKP,aAETQ,aAAc,WACVb,kBAAkBc,yBAG1BnB,EAAE,oBAAoBe,UAAU,CAC5BK,IAAK,QACLJ,SAAU,CACNC,IAAKP,aAETQ,aAAc,iBACJG,MAAQC,KAAKC,MAEnBlB,kBAAkBmB,iBAAiB,4BAA6BH,OAEhEhB,kBAAkBoB,eAAe,oBAAqBJ,OACtDhB,kBAAkBc,uBAEtBO,WAAY,CACR,CAACC,WAAW,EAAOC,SAAS,EAAOC,QAAS,cAGpD7B,EAAE,iBAAiBe,UAAU,CACzBC,SAAU,CACNC,IAAKP,aAETQ,aAAc,WACVb,kBAAkBc,yBAYtBW,GAEA9B,EAAE,0BAA0B+B,OAAM,SAASC,GACvCA,EAAEC,uBAEIC,WAAalC,EAAEsB,MAAMa,KAAK,WAG5BC,QAAU,CACV,CAACC,IAAK,+BAAgCC,UAAW,iCACjD,CAACD,IAAK,8BAA+BC,UAAW,gCAAiCC,MAJpEvC,EAAEsB,MAAMa,KAAK,aAK1B,CAACE,IAAK,oCAAqCC,UAAW,iCACtD,CAACD,IAAK,sCAAuCC,UAAW,kCAG5DpC,IAAIsC,YAAYJ,SAASK,MAAK,SAASL,gBAC5BjC,aAAauC,OAAO,CACvBC,MAAOP,QAAQ,GACfQ,KAAM,wFAEgDR,QAAQ,GAFxD,eAINS,OAAQ,0JAEwGX,WAAa,KAAOE,QAAQ,GAFpI,6HAGkHA,QAAQ,GAH1H,uBAMbK,MAAK,SAASK,OACbA,MAAMC,UAAUC,GAAG5C,YAAY6C,QAAQ,WACnCH,MAAMI,aAEVJ,MAAMK,aAIdnD,EAAE,QAAQgD,GAAG,QAAS,yCAAyC,iBAErDd,WAAalC,EAAEsB,MAAMa,KAAK,OAEhCnC,EAAEoD,KAAK,CACHnC,IAAKL,EAAEC,IAAIC,QAAU,+CACrBuC,OAAQ,OACRC,SAAU,OACVnB,KAAM,CACFoB,OAAQ,mBACRrB,WAAYA,WACZsB,QAAS5C,EAAEC,IAAI2C,SAEnBC,QAAS,SAAUtB,MAEXuB,OAAOC,SAASC,KADP,SAATzB,KACwBvB,EAAEC,IAAIC,QAAU,wDAEhBF,EAAEC,IAAIC,QAAU,4DAMxDd,EAAE,QAAQgD,GAAG,QAAS,wCAAwC,WAC1DhD,EAAE,UAAU6D"}