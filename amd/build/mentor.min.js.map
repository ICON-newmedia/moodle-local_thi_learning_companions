{"version":3,"file":"mentor.min.js","sources":["../src/mentor.js"],"sourcesContent":["/* eslint-disable max-len, jsdoc/require-jsdoc, require-jsdoc */\ndefine([\n    'jquery',\n    'core/config',\n    'core/str',\n    'core/modal_factory',\n    'core/modal_events',\n    'local_learningcompanions/datatables-helpers',\n    // 'local_learningcompanions/jquery.dataTables',\n    'local_learningcompanions/datatables',\n    'local_learningcompanions/select2'\n], function($, c, str, ModalFactory, ModalEvents, datatablesHelpers) {\n    async function initDatatables() {\n        datatablesHelpers.initMinSearch('.js-mentor-filter--min');\n        datatablesHelpers.initIncludeSearch('.js-mentor-filter--includes');\n\n        const languageUrl = await str.get_string('datatables_url', 'local_learningcompanions');\n\n        $('#askedquestionstable').DataTable({\n            language: {\n                url: languageUrl\n            },\n            initComplete: function() {\n                datatablesHelpers.makeTablesFullWidth();\n            }\n        });\n        $('#mymentorquestionstable').DataTable({\n            language: {\n                url: languageUrl\n            },\n            initComplete: function() {\n                datatablesHelpers.makeTablesFullWidth();\n            }\n        });\n        $('#allmentorquestionstable').DataTable({\n            language: {\n                url: languageUrl\n            },\n            initComplete: function() {\n                datatablesHelpers.makeTablesFullWidth();\n            }\n        });\n        $('#allmentorstable').DataTable({\n            dom: 'lrtip',\n            language: {\n                url: languageUrl,\n            },\n            initComplete: function() {\n                const table = this.api();\n\n                datatablesHelpers.setupSearchRules('.js-mentor-filter--search', table);\n\n                datatablesHelpers.addRedrawEvent('.js-mentor-filter', table);\n                datatablesHelpers.makeTablesFullWidth();\n            },\n            columnDefs: [\n                {orderable: false, visible: false, targets: 'no-show'}\n            ]\n        });\n        $('.lc_datatable').DataTable({\n            language: {\n                url: languageUrl\n            },\n            initComplete: function() {\n                datatablesHelpers.makeTablesFullWidth();\n            }\n        });\n    }\n\n    return {\n\n        select2: function() {\n            $('.select2').select2();\n        },\n\n        init: function() {\n            initDatatables();\n\n            $('.askedquestions-delete').click(function(e) {\n                e.preventDefault();\n\n                const questionid = $(this).data('qid');\n                const question = $(this).data('question');\n\n                var strings = [\n                    {key: 'modal-deletemyquestion-title', component: 'local_learningcompanions'},\n                    {key: 'modal-deletemyquestion-text', component: 'local_learningcompanions', param: question},\n                    {key: 'modal-deletemyquestion-okaybutton', component: 'local_learningcompanions'},\n                    {key: 'modal-deletemyquestion-cancelbutton', component: 'local_learningcompanions'},\n                ];\n\n                str.get_strings(strings).then(function(strings) {\n                    return ModalFactory.create({\n                        title: strings[0],\n                        body: '' +\n                            '<div id=\"mentor-deletemyquestion-modal\">' +\n                            '<div id=\"mentor-deletemyquestion-modal-text\">' + strings[1] + '</div>' +\n                            '</div>',\n                        footer: '' +\n                            '<div id=\"mentor-deletemyquestion-modal-buttons\">' +\n                            '<button class=\"btn btn-primary\" aria-hidden=\"true\" id=\"mentor-deletemyquestion-modal-delete\" data-qid=\"' + questionid + '\">' + strings[2] + '</button>' +\n                            '<button class=\"btn btn-secondary\" aria-hidden=\"true\" id=\"mentor-deletemyquestion-modal-close\" data-action=\"hide\">' + strings[3] + '</button>' +\n                            '</div>'\n                    });\n                }).then(function(modal) {\n                    modal.getRoot().on(ModalEvents.hidden, function() {\n                        modal.destroy();\n                    });\n                    modal.show();\n                });\n            });\n\n            $('body').on('click', '#mentor-deletemyquestion-modal-delete', function() {\n\n                const questionid = $(this).data('qid');\n\n                $.ajax({\n                    url: M.cfg.wwwroot + '/local/learningcompanions/ajax/ajax.php',\n                    method: 'POST',\n                    dataType: 'json',\n                    data: {\n                        action: 'deletemyquestion',\n                        questionid: questionid\n                    },\n                    success: function (data) {\n                        if (data === 'fail') {\n                            window.location.href = (M.cfg.wwwroot + '/local/learningcompanions/mentor/index.php?n=n_d');\n                        } else {\n                            window.location.href = (M.cfg.wwwroot + '/local/learningcompanions/mentor/index.php?n=d');\n                        }\n                    }\n                });\n            });\n\n            $('body').on('click', '#mentor-deletemyquestion-modal-close', function() {\n                $('.modal').remove();\n            });\n        }\n\n    };\n});\n"],"names":["define","$","c","str","ModalFactory","ModalEvents","datatablesHelpers","select2","init","initMinSearch","initIncludeSearch","languageUrl","get_string","DataTable","language","url","initComplete","makeTablesFullWidth","dom","table","this","api","setupSearchRules","addRedrawEvent","columnDefs","orderable","visible","targets","initDatatables","click","e","preventDefault","questionid","data","strings","key","component","param","get_strings","then","create","title","body","footer","modal","getRoot","on","hidden","destroy","show","ajax","M","cfg","wwwroot","method","dataType","action","success","window","location","href","remove"],"mappings":"AACAA,yCAAO,CACH,SACA,cACA,WACA,qBACA,oBACA,8CAEA,sCACA,qCACD,SAASC,EAAGC,EAAGC,IAAKC,aAAcC,YAAaC,yBA0DvC,CAEHC,QAAS,WACLN,EAAE,YAAYM,WAGlBC,KAAM,6BA9DNF,kBAAkBG,cAAc,0BAChCH,kBAAkBI,kBAAkB,qCAE9BC,kBAAoBR,IAAIS,WAAW,iBAAkB,4BAE3DX,EAAE,wBAAwBY,UAAU,CAChCC,SAAU,CACNC,IAAKJ,aAETK,aAAc,WACVV,kBAAkBW,yBAG1BhB,EAAE,2BAA2BY,UAAU,CACnCC,SAAU,CACNC,IAAKJ,aAETK,aAAc,WACVV,kBAAkBW,yBAG1BhB,EAAE,4BAA4BY,UAAU,CACpCC,SAAU,CACNC,IAAKJ,aAETK,aAAc,WACVV,kBAAkBW,yBAG1BhB,EAAE,oBAAoBY,UAAU,CAC5BK,IAAK,QACLJ,SAAU,CACNC,IAAKJ,aAETK,aAAc,iBACJG,MAAQC,KAAKC,MAEnBf,kBAAkBgB,iBAAiB,4BAA6BH,OAEhEb,kBAAkBiB,eAAe,oBAAqBJ,OACtDb,kBAAkBW,uBAEtBO,WAAY,CACR,CAACC,WAAW,EAAOC,SAAS,EAAOC,QAAS,cAGpD1B,EAAE,iBAAiBY,UAAU,CACzBC,SAAU,CACNC,IAAKJ,aAETK,aAAc,WACVV,kBAAkBW,yBAYtBW,GAEA3B,EAAE,0BAA0B4B,OAAM,SAASC,GACvCA,EAAEC,uBAEIC,WAAa/B,EAAEmB,MAAMa,KAAK,WAG5BC,QAAU,CACV,CAACC,IAAK,+BAAgCC,UAAW,4BACjD,CAACD,IAAK,8BAA+BC,UAAW,2BAA4BC,MAJ/DpC,EAAEmB,MAAMa,KAAK,aAK1B,CAACE,IAAK,oCAAqCC,UAAW,4BACtD,CAACD,IAAK,sCAAuCC,UAAW,6BAG5DjC,IAAImC,YAAYJ,SAASK,MAAK,SAASL,gBAC5B9B,aAAaoC,OAAO,CACvBC,MAAOP,QAAQ,GACfQ,KAAM,wFAEgDR,QAAQ,GAFxD,eAINS,OAAQ,0JAEwGX,WAAa,KAAOE,QAAQ,GAFpI,6HAGkHA,QAAQ,GAH1H,uBAMbK,MAAK,SAASK,OACbA,MAAMC,UAAUC,GAAGzC,YAAY0C,QAAQ,WACnCH,MAAMI,aAEVJ,MAAMK,aAIdhD,EAAE,QAAQ6C,GAAG,QAAS,yCAAyC,iBAErDd,WAAa/B,EAAEmB,MAAMa,KAAK,OAEhChC,EAAEiD,KAAK,CACHnC,IAAKoC,EAAEC,IAAIC,QAAU,0CACrBC,OAAQ,OACRC,SAAU,OACVtB,KAAM,CACFuB,OAAQ,mBACRxB,WAAYA,YAEhByB,QAAS,SAAUxB,MAEXyB,OAAOC,SAASC,KADP,SAAT3B,KACwBkB,EAAEC,IAAIC,QAAU,mDAEhBF,EAAEC,IAAIC,QAAU,uDAMxDpD,EAAE,QAAQ6C,GAAG,QAAS,wCAAwC,WAC1D7C,EAAE,UAAU4D"}