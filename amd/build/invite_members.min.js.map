{"version":3,"file":"invite_members.min.js","sources":["../src/invite_members.js"],"sourcesContent":["/* eslint-disable no-console */\nimport $ from 'jquery';\nimport {getInvitableUsers, inviteUser} from \"local_thi_learning_companions/repository\";\nimport Template from 'core/templates';\nimport KeyCodes from 'core/key_codes';\n\nexport const init = () => {\n    $('.js-invite-member-search-btn').click(handleSearchInviteButton);\n    $('.js-invite-member-input').keyup(handleSearchKeyup);\n    $('.js-invite-member-btn').click(handleInviteSubmit);\n};\n\nconst handleSearchInviteButton = async function(e) {\n    e.preventDefault();\n\n    const groupId = $(this).data('groupid');\n    const searchString = $('.js-invite-member-input').val();\n    $('.js-invite-member-btn').attr('disabled', true);\n\n    const users = await getInvitableUsers(searchString, groupId);\n    const checked = users.length === 1 ? 'checked' : '';\n\n    const {html} = await Template.renderForPromise('local_thi_learning_companions/group/group_invite_list', {\n        users,\n        checked,\n    });\n\n    if (checked) {\n        enableSubmitbutton();\n    }\n\n    $('.js-invite-member-list').html(html);\n    $('.js-invite-radio').click(enableSubmitbutton);\n};\n\nconst handleSearchKeyup = function(e) {\n    if (e.keyCode === KeyCodes.enter) {\n        handleSearchInviteButton.bind($('.js-invite-member-search-btn'))(e);\n    }\n};\n\nconst enableSubmitbutton = function() {\n    const submitButton = $('.js-invite-member-btn');\n    submitButton.removeAttr('disabled');\n};\n\nconst handleInviteSubmit = async function(e) {\n    e.preventDefault();\n\n    const groupId = $(this).data('groupid');\n    const userId = +$('input.js-invite-radio[type=radio]:checked').val();\n\n    const {errorcode} = await inviteUser(userId, groupId);\n\n    if (errorcode === 0) {\n        window.location.reload();\n    } else {\n        console.log(errorcode);\n    }\n};\n"],"names":["click","handleSearchInviteButton","keyup","handleSearchKeyup","handleInviteSubmit","async","e","preventDefault","groupId","this","data","searchString","val","attr","users","checked","length","html","Template","renderForPromise","enableSubmitbutton","keyCode","KeyCodes","enter","bind","removeAttr","userId","errorcode","window","location","reload","console","log"],"mappings":"ugBAMoB,yBACd,gCAAgCA,MAAMC,8CACtC,2BAA2BC,MAAMC,uCACjC,yBAAyBH,MAAMI,2BAG/BH,yBAA2BI,eAAeC,GAC5CA,EAAEC,uBAEIC,SAAU,mBAAEC,MAAMC,KAAK,WACvBC,cAAe,mBAAE,2BAA2BC,0BAChD,yBAAyBC,KAAK,YAAY,SAEtCC,YAAc,iCAAkBH,aAAcH,SAC9CO,QAA2B,IAAjBD,MAAME,OAAe,UAAY,IAE3CC,KAACA,YAAcC,mBAASC,iBAAiB,wDAAyD,CACpGL,MAAAA,MACAC,QAAAA,UAGAA,SACAK,yCAGF,0BAA0BH,KAAKA,0BAC/B,oBAAoBjB,MAAMoB,qBAG1BjB,kBAAoB,SAASG,GAC3BA,EAAEe,UAAYC,mBAASC,OACvBtB,yBAAyBuB,MAAK,mBAAE,gCAAhCvB,CAAiEK,IAInEc,mBAAqB,YACF,mBAAE,yBACVK,WAAW,aAGtBrB,mBAAqBC,eAAeC,GACtCA,EAAEC,uBAEIC,SAAU,mBAAEC,MAAMC,KAAK,WACvBgB,SAAU,mBAAE,6CAA6Cd,OAEzDe,UAACA,iBAAmB,0BAAWD,OAAQlB,SAE3B,IAAdmB,UACAC,OAAOC,SAASC,SAEhBC,QAAQC,IAAIL"}