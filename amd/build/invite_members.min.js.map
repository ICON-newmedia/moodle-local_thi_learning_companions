{"version":3,"file":"invite_members.min.js","sources":["../src/invite_members.js"],"sourcesContent":["/* eslint-disable no-console */\r\nimport $ from 'jquery';\r\nimport {getInvitableUsers, inviteUser} from \"local_thi_learning_companions/repository\";\r\nimport Template from 'core/templates';\r\nimport KeyCodes from 'core/key_codes';\r\n\r\nexport const init = () => {\r\n    $('.js-invite-member-search-btn').click(handleSearchInviteButton);\r\n    $('.js-invite-member-input').keyup(handleSearchKeyup);\r\n    $('.js-invite-member-btn').click(handleInviteSubmit);\r\n};\r\n\r\nconst handleSearchInviteButton = async function(e) {\r\n    e.preventDefault();\r\n\r\n    const groupId = $(this).data('groupid');\r\n    const searchString = $('.js-invite-member-input').val();\r\n    $('.js-invite-member-btn').attr('disabled', true);\r\n\r\n    const users = await getInvitableUsers(searchString, groupId);\r\n    const checked = users.length === 1 ? 'checked' : '';\r\n\r\n    const {html} = await Template.renderForPromise('local_thi_learning_companions/group/group_invite_list', {\r\n        users,\r\n        checked,\r\n    });\r\n\r\n    if (checked) {\r\n        enableSubmitbutton();\r\n    }\r\n\r\n    $('.js-invite-member-list').html(html);\r\n    $('.js-invite-radio').click(enableSubmitbutton);\r\n};\r\n\r\nconst handleSearchKeyup = function(e) {\r\n    if (e.keyCode === KeyCodes.enter) {\r\n        handleSearchInviteButton.bind($('.js-invite-member-search-btn'))(e);\r\n    }\r\n};\r\n\r\nconst enableSubmitbutton = function() {\r\n    const submitButton = $('.js-invite-member-btn');\r\n    submitButton.removeAttr('disabled');\r\n};\r\n\r\nconst handleInviteSubmit = async function(e) {\r\n    e.preventDefault();\r\n\r\n    const groupId = $(this).data('groupid');\r\n    const userId = +$('input.js-invite-radio[type=radio]:checked').val();\r\n\r\n    const {errorcode} = await inviteUser(userId, groupId);\r\n\r\n    if (errorcode === 0) {\r\n        window.location.reload();\r\n    } else {\r\n        console.log(errorcode);\r\n    }\r\n};\r\n"],"names":["click","handleSearchInviteButton","keyup","handleSearchKeyup","handleInviteSubmit","async","e","preventDefault","groupId","this","data","searchString","val","attr","users","checked","length","html","Template","renderForPromise","enableSubmitbutton","keyCode","KeyCodes","enter","bind","removeAttr","userId","errorcode","window","location","reload","console","log"],"mappings":"ugBAMoB,yBACd,gCAAgCA,MAAMC,8CACtC,2BAA2BC,MAAMC,uCACjC,yBAAyBH,MAAMI,2BAG/BH,yBAA2BI,eAAeC,GAC5CA,EAAEC,uBAEIC,SAAU,mBAAEC,MAAMC,KAAK,WACvBC,cAAe,mBAAE,2BAA2BC,0BAChD,yBAAyBC,KAAK,YAAY,SAEtCC,YAAc,iCAAkBH,aAAcH,SAC9CO,QAA2B,IAAjBD,MAAME,OAAe,UAAY,IAE3CC,KAACA,YAAcC,mBAASC,iBAAiB,wDAAyD,CACpGL,MAAAA,MACAC,QAAAA,UAGAA,SACAK,yCAGF,0BAA0BH,KAAKA,0BAC/B,oBAAoBjB,MAAMoB,qBAG1BjB,kBAAoB,SAASG,GAC3BA,EAAEe,UAAYC,mBAASC,OACvBtB,yBAAyBuB,MAAK,mBAAE,gCAAhCvB,CAAiEK,IAInEc,mBAAqB,YACF,mBAAE,yBACVK,WAAW,aAGtBrB,mBAAqBC,eAAeC,GACtCA,EAAEC,uBAEIC,SAAU,mBAAEC,MAAMC,KAAK,WACvBgB,SAAU,mBAAE,6CAA6Cd,OAEzDe,UAACA,iBAAmB,0BAAWD,OAAQlB,SAE3B,IAAdmB,UACAC,OAAOC,SAASC,SAEhBC,QAAQC,IAAIL"}