function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}define("local_learningcompanions/group",["exports","jquery","core/str","core/modal_factory","core/modal_events","local_learningcompanions/datatables-helpers","local_learningcompanions/ajax","local_learningcompanions/jquery.dataTables","local_learningcompanions/select2"],(function(_exports,_jquery,str,ModalFactory,ModalEvents,datatablesHelpers,_ajax,_jquery2,_select){var obj;function _getRequireWildcardCache(nodeInterop){if("function"!=typeof WeakMap)return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(null===obj||"object"!==_typeof(obj)&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if("default"!==key&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}return newObj.default=obj,cache&&cache.set(obj,newObj),newObj}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.select2=_exports.init=void 0,_jquery=(obj=_jquery)&&obj.__esModule?obj:{default:obj},str=_interopRequireWildcard(str),ModalFactory=_interopRequireWildcard(ModalFactory),ModalEvents=_interopRequireWildcard(ModalEvents),datatablesHelpers=_interopRequireWildcard(datatablesHelpers);_exports.select2=function(){(0,_jquery.default)(".select2").select2()};_exports.init=function(){setupDatatables(),attachEvents()};var _ref,setupDatatables=(_ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var url;return regeneratorRuntime.wrap((function(_context){for(;;)switch(_context.prev=_context.next){case 0:return datatablesHelpers.initMinSearch(".js-group-filter--min"),datatablesHelpers.initIncludeSearch(".js-group-filter--includes"),_context.next=4,str.get_string("datatables_url","local_learningcompanions");case 4:url=_context.sent,(0,_jquery.default)("#allgroupstable").DataTable({dom:"lrtip",language:{url:url},initComplete:function(){var table=this.api();datatablesHelpers.setupSearchRules(".js-group-filter--search",table),datatablesHelpers.addRedrawEvent(".js-group-filter",table)}});case 6:case"end":return _context.stop()}}),_callee)}))),function(){return _ref.apply(this,arguments)}),attachEvents=function(){var _ref2,_ref3,_ref4,_ref5,body=(0,_jquery.default)("body");(0,_jquery.default)(".grouprow").click((_ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(e){var groupid,groupname,groupDetails,title,modal;return regeneratorRuntime.wrap((function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return e.preventDefault(),groupid=(0,_jquery.default)(this).data("gid"),groupname=(0,_jquery.default)(this).data("title"),_context2.next=5,(0,_ajax.promiseAjax)(M.cfg.wwwroot+"/local/learningcompanions/ajax.php",{action:"getgroupdetails",groupid:groupid});case 5:return groupDetails=_context2.sent,_context2.next=8,str.get_string("modal-groupdetails-groupname","local_learningcompanions",groupname);case 8:return title=_context2.sent,_context2.next=11,ModalFactory.create({title:title,body:groupDetails,footer:"",large:!0});case 11:(modal=_context2.sent).getRoot().on(ModalEvents.hidden,(function(){modal.destroy()})),modal.show();case 14:case"end":return _context2.stop()}}),_callee2,this)}))),function(_x){return _ref2.apply(this,arguments)})),body.on("click","#mentor-deletemyquestion-modal-close",(function(){(0,_jquery.default)(".modal").remove()})),body.on("click",".js-leave-group",(_ref3=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(e){return regeneratorRuntime.wrap((function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return e.preventDefault(),_context3.next=3,(0,_ajax.promiseAjax)(M.cfg.wwwroot+"/local/learningcompanions/ajax.php",{action:"leavegroup",groupid:(0,_jquery.default)(this).data("groupid")});case 3:_context3.sent||window.location.reload();case 5:case"end":return _context3.stop()}}),_callee3,this)}))),function(_x2){return _ref3.apply(this,arguments)})),body.on("click",".js-request-join-group",(_ref4=_asyncToGenerator(regeneratorRuntime.mark((function _callee4(e){var errorMessage;return regeneratorRuntime.wrap((function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return e.preventDefault(),_context4.next=3,(0,_ajax.promiseAjax)(M.cfg.wwwroot+"/local/learningcompanions/ajax.php",{action:"requestgroupjoin",groupid:(0,_jquery.default)(this).data("groupid")});case 3:if(_context4.sent){_context4.next=8;break}window.location.reload(),_context4.next=12;break;case 8:return _context4.next=10,str.get_string("group_request_not_possible","local_learningcompanions");case 10:errorMessage=_context4.sent,alert(errorMessage);case 12:case"end":return _context4.stop()}}),_callee4,this)}))),function(_x3){return _ref4.apply(this,arguments)})),body.on("click",".js-join-group",(_ref5=_asyncToGenerator(regeneratorRuntime.mark((function _callee5(e){return regeneratorRuntime.wrap((function(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return e.preventDefault(),_context5.next=3,(0,_ajax.promiseAjax)(M.cfg.wwwroot+"/local/learningcompanions/ajax.php",{action:"joingroup",groupid:(0,_jquery.default)(this).data("groupid")});case 3:_context5.sent||window.location.reload();case 5:case"end":return _context5.stop()}}),_callee5,this)}))),function(_x4){return _ref5.apply(this,arguments)}))}}));

//# sourceMappingURL=group.min.js.map