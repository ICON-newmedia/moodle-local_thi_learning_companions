<?phpfunction local_learningcompanions_extend_settings_navigation() {    global $PAGE;    if (!isloggedin()){        return;    }    $config = get_config('local_learningcompanions');    $params = array(        $config->button_css_selector,        $config->button_bg_color,        $config->button_text_color,        $config->button_radius,    );    $PAGE->requires->js_call_amd('local_learningcompanions/learningcompanions', 'init', $params);}function get_attachments_of_chat_comments(array $comments, string $area) {    // ICTODO: also get inline attachments    $itemids = array_keys($comments);    $filestorage = get_file_storage();    $context = \context_system::instance();    $files = $filestorage->get_area_files(        $context->id,        'local_learningcompanions',        $area,        $itemids,        'filename',        false    );    $filesbyid = array_reduce($comments, function($carry, $comment) {        $carry[$comment->id] = [];        return $carry;    }, []);    return array_reduce($files, function($carry, $file) {        $itemid = $file->get_itemid();        $carry[$itemid] = array_merge($carry[$itemid], [$file]);        return $carry;    }, $filesbyid);}